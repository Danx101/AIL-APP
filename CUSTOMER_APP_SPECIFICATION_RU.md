# Техническое задание - Мобильное приложение для клиентов
## Abnehmen im Liegen Customer App

### Версия: 1.0.0
### Дата: 13.01.2025

---

## 📱 Обзор системы

Мобильное приложение для клиентов студий "Abnehmen im Liegen" - система для управления процессом похудения, отслеживания прогресса и мотивации клиентов на протяжении всего курса процедур.

### Основные цели
- Упрощение активации и использования купленных пакетов сессий
- Усиление мотивации и вовлеченности клиентов
- Отслеживание прогресса с визуализацией результатов
- Персонализированное сопровождение процесса похудения
- Интеграция питания и образа жизни в программу

---

## 🚀 Процесс активации аккаунта

### 1. Регистрация с использованием кода

#### Экран ввода кода
```
Поля:
- Код регистрации (формат: XXX-YYY)
- Email
- Пароль
- Подтверждение пароля

Валидация:
- Проверка существования кода через API
- Проверка соответствия email (если уже указан в системе)
- Пароль: минимум 8 символов, 1 цифра, 1 заглавная буква
```

#### API запрос
```json
POST /api/v1/auth/register-customer-enhanced
{
  "registrationCode": "BER-456",
  "email": "customer@email.com",
  "password": "SecurePass123",
  "sendVerificationEmail": true
}
```

### 2. Первичная анкета (онбординг)

#### Экран 1: Цели похудения
```
Вопрос: "Какая ваша главная цель?"
Варианты (множественный выбор):
□ Похудеть на N кг
□ Улучшить здоровье
□ Подготовиться к событию
□ Улучшить самочувствие
□ Уменьшить объемы в проблемных зонах
□ Другое (текстовое поле)

Дополнительный вопрос:
"На сколько кг вы хотите похудеть?"
[Слайдер: 3-50 кг]

"К какой дате хотите достичь цели?"
[Календарь с ограничением минимум 1 месяц]
```

#### Экран 2: Текущие параметры
```
Обязательные поля:
- Рост (см): [140-220]
- Текущий вес (кг): [40-200]
- Пол: М/Ж
- Дата рождения

Опциональные поля (можно пропустить):
- Объем талии (см)
- Объем бедер (см)
- Объем груди (см)
- Объем рук (см)
- Объем ног (см)

Кнопка: "Заполнить позже"
```


#### Экран 3: Фото "До"
```
Инструкция:
"Сделайте 3 фото для отслеживания прогресса.
Эти фото видите только вы."

Фото:
1. Спереди
2. Сбоку
3. Сзади

Рекомендации:
- Однотонный фон
- Хорошее освещение
- Облегающая одежда или купальник
- Та же одежда для будущих фото

[Кнопка: Сделать фото]
[Кнопка: Пропустить]
```

---

## 📊 Главный экран (Dashboard)

### Структура главного экрана

```
┌─────────────────────────┐
│   Привет, Анна! 👋      │
│   День 15 из 60         │
├─────────────────────────┤
│  ВОДНЫЙ БАЛАНС 💧       │
│  ████████░░ 1.8л/2.5л   │
│  🔥 Streak: 12 дней     │
│  [+ Стакан] [💧 Детали] │
├─────────────────────────┤
│  ПРОГРЕСС               │
│  ████████░░ 8/20 сессий │
│  Потеряно: -3.5 кг      │
│  До цели: 6.5 кг        │
├─────────────────────────┤
│  СЛЕДУЮЩАЯ ЗАПИСЬ       │
│  15 янв, 14:00          │
│  ⏰ Не есть с 02:00     │
│  [Отменить] [Изменить]  │
├─────────────────────────┤
│  БЫСТРЫЕ ДЕЙСТВИЯ       │
│  [📸 Фото] [⚖️ Вес]     │
│  [📏 Замеры] [🍽 План]  │
└─────────────────────────┘
```

### Виджеты dashboard

#### Прогресс-виджет
- Круговая диаграмма использованных сессий
- График изменения веса (линейный)
- Текущие достижения (бейджи)

#### Календарь записей
- Отображение всех будущих записей
- Цветовая индикация (прошедшие/будущие)
- Быстрая отмена (если >48 часов)

#### Мотивационный виджет
- Ежедневная мотивационная цитата
- Streak дней в программе
- Напоминание о цели

---

## 💧 Система водного баланса

### Центральная роль гидратации

Водный баланс является **критически важным** элементом программы похудения и занимает приоритетное место в приложении. Правильная гидратация:
- Повышает эффективность процедур
- Ускоряет метаболизм на 24-30%
- Улучшает детоксикацию организма
- Снижает чувство голода
- Улучшает состояние кожи

### Персональная норма воды

#### Автоматический расчет нормы
```javascript
function calculateWaterNorm(userData) {
  const baseNorm = userData.weight * 30; // мл на кг веса
  const activityBonus = userData.activity_level === 'high' ? 500 : 250;
  const sessionBonus = userData.has_session_today ? 300 : 0;
  const weatherBonus = isHotWeather() ? 200 : 0;
  
  return Math.min(baseNorm + activityBonus + sessionBonus + weatherBonus, 3500);
}

// Для клиента 70кг: 70*30 + 250 + 300 = 2650мл
```

#### Настройка нормы
```
Ваша персональная норма:

Базовая (30мл × 70кг): 2100мл
+ Активность: +250мл
+ День процедуры: +300мл
= Итого: 2650мл

[Авто-расчет] [Ручная настройка]

Ручная настройка: [2500мл] 
Диапазон: 1500-3500мл
```

### Основной экран водного баланса

#### Детальный виджет воды
```
┌─────────────────────────┐
│ ВОДНЫЙ БАЛАНС 💧        │
├─────────────────────────┤
│    ████████░░           │
│     2.1л / 2.5л         │
│       84%               │
├─────────────────────────┤
│ 🔥 Streak: 12 дней      │
│ 🏆 Рекорд: 28 дней      │
├─────────────────────────┤
│ Выпито сегодня:         │
│ ☑️ 08:00 - 250мл        │
│ ☑️ 10:30 - 200мл        │
│ ☑️ 13:15 - 300мл        │
│ ☑️ 15:45 - 250мл        │
      │
├─────────────────────────┤
│ [+150мл] [+250мл] [+500мл]│
│ [Произвольно: ___мл]    │
└─────────────────────────┘
```

#### Недельная статистика
```
Неделя 15-21 января:

ПН ██████████ 2.5л ✓
ВТ ████████░░ 2.1л 
СР ██████████ 2.6л ✓
ЧТ ██████████ 2.5л ✓
ПТ ████████░░ 2.0л
СБ ██████████ 2.7л ✓
ВС ██████████ 2.5л ✓

Средний объем: 2.4л
Дней с нормой: 5/7 (71%)
Лучший день: СБ (2.7л)
```

### Умные напоминания о воде

#### Адаптивная система напоминаний
```javascript
function getWaterReminder(userData, currentTime) {
  const progress = userData.todayWaterIntake / userData.dailyNorm;
  const timeLeft = getHoursUntilBedtime(userData.bedtime);
  const reminderInterval = calculateOptimalInterval(progress, timeLeft);
  
  return {
    shouldRemind: progress < 0.8 && timeLeft > 2,
    interval: reminderInterval,
    urgency: progress < 0.5 && timeLeft < 4 ? 'high' : 'normal'
  };
}
```

#### Типы напоминаний
```
ОБЫЧНЫЕ:
"💧 Время выпить воды! 
Прогресс: 1.2л/2.5л (48%)"

МОТИВАЦИОННЫЕ:
"💧 Вода = красота изнутри! 
Ваша кожа скажет спасибо ✨"

СРОЧНЫЕ:
"💧 Внимание! До конца дня 3 часа
Нужно выпить еще 800мл"

ПЕРСОНАЛИЗИРОВАННЫЕ:
"💧 Перед процедурой завтра особенно важно! 
Допейте норму сегодня"

ДОСТИЖЕНИЯ:
"💧 10 дней подряд! Вы водный чемпион! 🏆"
```

### Визуализация прогресса

#### Анимированный индикатор
```
Стакан с анимацией наполнения:
      ┌─────┐
      │░░░░░│ ← пустая область
      │█████│ ← заполненная область
      │█████│   с волновой анимацией
      │█████│
      └─────┘
     2.1л/2.5л
```

#### График потребления
```
График за неделю:

3.0л┤                    
2.5л┤ ●─●───●─●─────●─●  
2.0л┤     ●     ●        
1.5л┤                    
1.0л┤                    
    └┬─┬─┬─┬─┬─┬─┬────────
     ПН ВТ СР ЧТ ПТ СБ ВС

Тренд: ↗️ +200мл в неделю
```

### Геймификация водного баланса

#### Система достижений
```
ВОДНЫЕ ДОСТИЖЕНИЯ:

🚰 "Первые шаги" - 3 дня подряд
💧 "Хорошая привычка" - 7 дней подряд  
🌊 "Водопад" - 14 дней подряд
🏆 "Водный мастер" - 30 дней подряд
💎 "Источник жизни" - 90 дней подряд

СПЕЦИАЛЬНЫЕ:
⚡ "Утренний старт" - вода до 9 утра
🎯 "Точность" - попадание в норму ±50мл
💪 "Перевыполнение" - 110% от нормы

• "Ранняя пташка" (стакан до 8 утра)
• "Ночной финиш" (норма до 20:00)
• "Двойная норма" (150% в день процедуры)
```

### Интеграция с другими функциями

#### Связь с процедурами
```
ДЕНЬ ПРОЦЕДУРЫ:

Специальный режим:
• Норма +300мл
• Напоминание за 2 часа до сессии
• Восстановительный режим после

"💧 Сегодня ваша процедура!
Норма увеличена до 2.8л

```

#### Влияние на питание
```
В плане питания:

"💧 Стакан воды за 20 минут до еды
поможет контролировать аппетит"

"💧 Если чувствуете голод между приемами
пищи - сначала выпейте воды"

💡 Недостаток воды может задерживать
жидкость в организме"
```


#### Водные цитаты
```
Ежедневные мотивационные сообщения:

"💧 Вода - источник молодости и красоты"
"💧 Каждый глоток приближает к цели"
"💧 Гидратация = детоксикация = результат"
"💧 Вода запускает процесс жиросжигания"
"💧 Красивая кожа начинается изнутри"
```

## 🎯 Система целеполагания

### Автоматическое создание целей

#### Расчет реалистичной цели
```javascript
// При завершении блока сессий
function calculateGoal(currentBlock, userData) {
  const sessionsPerWeek = 2;
  const weeksInBlock = currentBlock.sessions / sessionsPerWeek;
  const avgWeightLossPerWeek = 0.5; // кг
  
  return {
    recommendedGoal: weeksInBlock * avgWeightLossPerWeek,
    minGoal: weeksInBlock * 0.3,
    maxGoal: weeksInBlock * 0.8,
    timeframe: weeksInBlock
  };
}
```

#### Интерфейс установки цели
```
"Отличная работа! Вы завершили блок из 10 сессий!"

Ваш прогресс:
- Потеряно веса: 2.5 кг
- Уменьшение объемов: -8 см
[Подробно]

Цель на следующий блок:
[Слайдер: 2-5 кг]
Рекомендуем: 3 кг за 5 недель

[Установить цель]
```

### Промежуточные цели
- Мини-цели каждые 5 сессий
- Недельные цели по весу (в зависимости от общей цели)
- Цели по замерам

---

## 📈 Отслеживание прогресса

### После каждой сессии

#### Экран ввода данных
```
Сессия #8 завершена! 

Введите ваши данные:

Вес: [___] кг
(Предыдущий: 75.5 кг)

Замеры (см):
Талия: [___] (-2 см с начала)
Бедра: [___] (-3 см с начала)
Грудь: [___] 
Руки: [___]
Ноги: [___]

Самочувствие:
😊 😐 😔

Комментарий (опционально):
[_________________]

[Сохранить]
```

### Визуализация прогресса

#### Графики
1. **График веса**
   - Линейный график с трендом
   - Отметки сессий
   - Прогноз достижения цели

2. **График объемов**
   - Мультилинейный график всех замеров
   - Процентное изменение

3. **Фото-сравнение**
   - Слайдер "До/После"
   - Галерея по блокам сессий
   - Автоматическое выравнивание фото

### Система празднования достижений

#### Уведомления о достижениях
```
🎉 Поздравляем!
Вы потеряли первые 5 кг!
Так держать!

[Поделиться] [Продолжить]
```

#### Бейджи и награды
- "Первые 5 кг" 🏆
- "10 сессий подряд" 🔥
- "Месяц в программе" 📅
- "Цель достигнута" 🎯
- "Супер мотивация" 💪

---

## 🍽 Персонализированный план питания

### Анкета по питанию

#### Экран 1: Предпочтения
```
Ваш тип питания:
○ Всеядный
○ Вегетарианец
○ Веган
○ Пескетарианец

Исключить продукты:
□ Глютен
□ Лактоза
□ Орехи
□ Морепродукты
□ Другое: [____]

Любимые продукты:
[+ Добавить продукт]
```

#### Экран 2: Режим
```
Сколько раз в день вы едите?
○ 2-3 раза
○ 4-5 раз
○ 6+ раз

Время основных приемов пищи:
Завтрак: [08:00]
Обед: [13:00]
Ужин: [19:00]

Готовите дома?
○ Всегда
○ Часто
○ Редко
○ Никогда
```

### Генерация плана через LLM

#### API запрос к LLM
```json
{
  "user_data": {
    "weight": 75,
    "height": 165,
    "age": 35,
    "gender": "female",
    "activity_level": "moderate",
    "weight_loss_goal": 5
  },
  "preferences": {
    "diet_type": "omnivore",
    "excluded": ["gluten", "lactose"],
    "favorite_foods": ["chicken", "rice", "vegetables"],
    "meals_per_day": 4
  },
  "request": "Generate 7-day meal plan with recipes"
}
```

### Интерфейс плана питания

```
┌─────────────────────────┐
│  ПН, 15 января          │
├─────────────────────────┤
│ Завтрак (350 ккал)      │
│ Овсянка с ягодами       │
│ [Рецепт] [Заменить]     │
├─────────────────────────┤
│ Перекус (150 ккал)      │
│ Яблоко + миндаль        │
├─────────────────────────┤
│ Обед (450 ккал)         │
│ Куриная грудка с овощами│
│ [Рецепт] [Заменить]     │
├─────────────────────────┤
│ Ужин (400 ккал)         │
│ Салат с тунцом          │
│ [Рецепт] [Заменить]     │
├─────────────────────────┤
│ Итого: 1350 ккал        │
│ Б: 95г Ж: 45г У: 140г   │
└─────────────────────────┘
```

---

## ⏰ Система напоминаний

### Типы напоминаний

#### 1. Напоминание о голодании (12 часов до сессии)
```
Push-уведомление:
"⏰ Напоминание: не есть до завтрашней процедуры!
Последний прием пищи до 02:00
Ваша запись: 15 янв, 14:00"

[Понятно] [Отложить на 1 час]
```

#### 2. Напоминание о записи (24 часа)
```
"📅 Завтра ваша процедура!
15 янв в 14:00
Адрес: Hauptstraße 1

[Подтвердить] [Отменить] [Изменить]"
```

#### 3. Мотивационные напоминания
```
Ежедневно в 9:00:
"💪 Новый день - новые возможности!
До цели осталось: 4.5 кг
Вы справитесь!"
```

#### 4. Напоминания о вводе данных
```
После сессии:
"📊 Не забудьте записать ваш прогресс!
Введите вес и замеры"

[Ввести сейчас] [Позже]
```

#### 5. Напоминания о водном балансе
```
Утром (8:00):
"💧 Доброе утро! Начните день со стакана воды
Ваша цель сегодня: 2.5 л"

В течение дня (каждые 2 часа):
"💧 Время выпить воды!
Выпито: 1.2л / 2.5л
Осталось: 1.3л"

Вечером (20:00):
"💧 Почти конец дня!
Выпито: 2.1л / 2.5л
Допейте еще 400мл"

Мотивационные:
"💧 7 дней подряд пьете норму! Отличная работа!"
"💧 Гидратация = детоксикация = результат!"
```

### Настройки напоминаний
```
Настройки уведомлений:

□ Напоминание о голодании (12ч)
□ Напоминание о записи (24ч)
□ Мотивационные сообщения
□ Запрос данных после сессии
□ Еженедельный отчет прогресса
□ Напоминания о воде (умные)

Водный режим:
Норма в день: [2.5л] (авто-расчет)
Частота напоминаний: [Каждые 2 часа]
Время начала: [08:00]
Время окончания: [20:00]
```

---

## 📅 Управление записями

### Просмотр записей
```
Мои записи:

ПРЕДСТОЯЩИЕ:
┌─────────────────────────┐
│ 15 янв, ПН - 14:00      │
│ Сессия #9 из 20         │
│ [Отменить] [Изменить]   │
├─────────────────────────┤
│ 18 янв, ЧТ - 10:00      │
│ Сессия #10 из 20        │
│ [Отменить] [Изменить]   │
└─────────────────────────┘

ПРОШЕДШИЕ:
┌─────────────────────────┐
│ 12 янв - ✓ Завершено    │
│ 10 янв - ✓ Завершено    │
│ 8 янв - ✓ Завершено     │
└─────────────────────────┘
```

### Отмена записи

#### Правила отмены
```javascript
function canCancelAppointment(appointment) {
  const hoursUntil = getHoursUntil(appointment.datetime);
  const studioPolicy = appointment.studio.cancellation_hours || 48;
  
  return {
    canCancel: hoursUntil >= studioPolicy,
    hoursRemaining: hoursUntil,
    message: hoursUntil < studioPolicy ? 
      `Отмена возможна за ${studioPolicy} часов` : 
      'Отмена без потери сессии'
  };
}
```

#### Диалог отмены
```
Отменить запись?

15 января, 14:00
Осталось: 52 часа

✓ Отмена без потери сессии

Причина (опционально):
○ Болезнь
○ Работа
○ Личные обстоятельства
○ Другое: [____]

[Отменить запись] [Назад]
```

---

## 📸 Система фотографий

### Загрузка фото

#### Периодичность
- При регистрации (фото "До")
- После каждого блока сессий (10/20/30/40)
- По желанию пользователя

#### Интерфейс камеры
```
┌─────────────────────────┐
│                         │
│    [Силуэт человека]    │
│    [Рамка выравнивания] │
│                         │
│   📷                    │
└─────────────────────────┘

Подсказки:
- Встаньте в рамку
- Держите телефон вертикально
- Используйте таймер

[Таймер: 3 сек] [Сделать фото]
```

### Сравнение фото


1. **Слайдер** - перетаскивание для сравнения
2. **Рядом** - два фото рядом


#### Экран сравнения
```
До (01.01.2025) | После (13.01.2025)

[Фото 1]         [Фото 2]

Изменения:
Вес: -3.5 кг
Талия: -5 см
Дней в программе: 13

[Поделиться] [Сохранить]
```

---

## 🔔 Система мотивации и вовлечения

### Ежедневные элементы

#### Streak-счетчик
```
🔥 15 дней подряд в программе!
Ваш рекорд: 15 дней
```

#### Прогресс-бар дня
```
Сегодняшние задачи:
💧 Выпить норму воды ████████░░ 2.1л/2.5л
⚖️ Взвеситься ✓
🍽 Записать питание □

```

### Еженедельные отчеты

```
📊 Ваша неделя

Результаты:
• Потеряно: 0.8 кг
• Сессий пройдено: 2
• Дней в программе: 7

Лучшие моменты:
• Новый минимум веса!
• 100% посещаемость

Фокус на следующую неделю:
• 2 записи запланировано
• Цель: -0.5 кг

[Подробнее] [Поделиться]
```

### Геймификация

#### Челленджи
```
Активные челленджи:

💧 "ГЛАВНЫЙ: Водный мастер" (ПРИОРИТЕТ #1)
Выпивать норму воды 14 дней подряд
████████████░░ 12/14 дней
Награда: +200 XP + титул "Водный гуру"

💧 "Утренняя гидратация"
Стакан воды в первые 30 минут дня
██████░░░░ 6/10 дней

🎯 "Пунктуальность"
Не пропустить ни одной записи
██████████ 10/10 сессий ✓

СЛЕДУЮЩИЕ ЧЕЛЛЕНДЖИ:
💧 "Идеальная неделя" (7 дней норма + своевременность)
💧 "Двойная гидратация" (150% в дни процедур)
💧 "Равномерность" (каждые 2 часа 7 дней)
```

---

## 🔐 Безопасность и приватность

### Хранение данных
- Фото: зашифрованное хранилище, доступ только владельцу
- Медицинские данные: соответствие GDPR
- Пароли: bcrypt хеширование
- Токены: JWT с ротацией

### Настройки приватности
```
Приватность:

□ Разрешить анонимную статистику
□ Получать персонализированные советы
□ Делиться прогрессом в студии
□ Участвовать в групповых челленджах

Удаление данных:
[Запросить удаление аккаунта]
```

---

## 📱 Технические требования

### Платформы
- iOS 13.0+
- Android 8.0+ (API level 26)

### Основной стек
- React Native / Flutter
- Redux/MobX для state management
- AsyncStorage для локального хранения
- Push-уведомления: FCM + APNS

### API интеграции
- Backend API (существующий)
- LLM API для генерации планов питания (OpenAI/Claude API)
- Сервис хранения изображений (S3/Cloudinary)
- Аналитика (Firebase Analytics)

### Offline-режим
- Кеширование данных о записях
- Локальное хранение прогресса
- Синхронизация при подключении

---

## 🚀 Roadmap развития

### Phase 1 (MVP) - 2 месяца ⭐ ПРИОРИТЕТ ВОДА
- Регистрация и онбординг
- **💧 Полная система водного баланса (ПРИОРИТЕТ #1)**
  - Персональный расчет нормы
  - Быстрый ввод потребления
  - Умные напоминания о воде
  - Streak-счетчик водной дисциплины
- Просмотр записей и сессий
- Базовый ввод данных (вес)
- Push-уведомления о голодании

### Phase 2 - 1 месяц
- **💧 Расширенная водная геймификация**
  - Водные достижения и челленджи
  - Интеграция с днями процедур
  - Визуальная аналитика потребления
- Полная система замеров
- Фото и сравнение
- Отмена записей

### Phase 3 - 1.5 месяца
- План питания с LLM (включая водный режим)
- Система целей
- Полная геймификация
- **💧 Социальные водные челленджи**

### Phase 4 - 1 месяц
- Интеграция с фитнес-трекерами
- **💧 Умная бутылка (IoT интеграция)**
- Групповые челленджи
- Чат поддержки

---

## 📊 Метрики успеха

### Ключевые показатели
- Retention Day 7: >70%
- Retention Day 30: >50%
- **💧 Ежедневное использование водного трекера: >85%**
- **💧 Выполнение водной нормы (streak >3 дня): >60%**
- Ввод данных после сессии: >80%
- Использование плана питания: >60%
- Завершение онбординга: >90%
- Отмены записей: <10%

### Водные метрики (приоритет)
- **💧 Средний streak водной дисциплины: >7 дней**
- **💧 % клиентов с водными достижениями: >75%**
- **💧 Ответ на водные напоминания: >70%**
- **💧 Корреляция вода-результат: отслеживать**

### Пользовательские метрики
- Средняя потеря веса за блок
- % достижения целей
- Engagement score
- NPS (Net Promoter Score)

---

## 🎨 UI/UX принципы

### Дизайн-принципы
1. **Простота** - минимум шагов для любого действия
2. **Мотивация** - позитивный и поддерживающий тон
3. **Прогресс** - визуализация достижений на каждом экране
4. **Персонализация** - адаптация под цели пользователя

### Цветовая схема
- Основной: #4CAF50 (зеленый - здоровье)
- Акцент: #FF9800 (оранжевый - энергия)
- Успех: #8BC34A (светло-зеленый)
- Предупреждение: #FFC107 (желтый)
- Ошибка: #F44336 (красный)

### Типографика
- Заголовки: SF Pro Display (iOS) / Roboto (Android)
- Основной текст: System font
- Размеры: 16px основной, 20px заголовки, 14px подписи

---

*Версия: 1.0.0*
*Дата создания: 13.01.2025*
*Автор: Abnehmen im Liegen Development Team*